# 基于深度学习的篮球战术采集系统——————数据集构建模块

## 篮球视频标注软件

### 必看！！！有些使用到的绝对路径需要您根据注释自行修改如下：
    1.My_design 207行  输入视频的绝对地址
    2.My_design 369行  输出图像集的绝对地址
    3.My_design 388行  输入图像集文件的绝对地址
### 必看！！！如果视频无法播放，您需要安装如下插件：
    下载地址：https://codecguide.com/download_k-lite_codec_pack_basic.htm

————————————————————软件介绍————————————————————————

### 主要功能：

        1.视频抽帧：对于输入而来的视频进行抽帧处理，形成图像集
        2.图像标注：用于标注形成csv文件
        3.文件转换：csv --> xml,ava

### 主要模块：

        1.注册模块
        2.登录模块
        3.视频抽帧模块：获取图片数据集
        4.图片标注模块：标注获取input.csv文件

### 数据集用途：

#### input.csv用途：

        -->xml: 在slowfast行为识别模块中找到PATH:"D:\slow_fast\ava\convert_to_xml_ava.py"
             使用convert_to_xml_ava.py在指定路径下（我的PATH："D:/篮球数据集汇总/annotation/xml1/")生成xml文件
        -->ava: 在slowfast行为识别模块中找到PATH:"D:\slow_fast\ava\convert_to_xml_ava.py"
             使用convert_to_xml_ava.py在PATH:"D:\slow_fast\ava"生成annotations中的val,train,tval,dtrain
                                     在PATH:"D:\slow_fast\ava"生成frame_list中的train,val

#### xml用途：

     1.用于 yolov5 的 VOC数据集 详情见目标检测模块
     2.用于 deepsort 的 图像分割数据集 详情见多目标跟踪模块

#### ava用途：

        用于slowfast行为识别数据集 详情见行为识别模块

### 使用说明:

#### 标注组员必看：

    1.需要提交的结果
    (1) tempdata.csv 临时标注文件存放了自己标注的数据集
    表头格式：video_name,frame_id,x1,y1,x2,y2,action_id,person_id
    (2) 截取图片的压缩包
    2.标注注意事项
     main_entrance.py为主函数入口
    （1）标注要时刻注意当前的动作类型是否发生了变化！！标注要时刻注意当前的动作类型是否发生了变化！！标注要时刻注意当前的动作类型是否发生了变化！！
        发生变换要用下拉框切换动作，再进行标注
    （2）默认可实现自动导出数据，切下一页即可自动保存csv文件。
        摁F2键切换成可以手动导出数据，点击导出即可
        使用自动导出数据要注意标注到最后一页的时候记得再点下一页，不然最后一页无法保存
    （3）千万不要使用后退键！！！千万不要使用后退键！！！千万不要使用后退键！！！
        后退键存在bug，会吞噬已经标注的数据
    （4）图片的命名格式：视频编号_帧数 即 video_name_frame_id
        对图片使用下滑轮可以查看当前标注的图片的帧数
     (5) 对图片标注错误后，可以点击撤销键撤销上一步操作！！！
     (6) 善用’删除‘->’应用‘,'恢复’->'应用'按钮：解决有球员淡出画面，有新球员进入画面的情况！！！
     (7) 人物重叠问题:当两个人物重叠时，标注被遮挡的那个人时尽量只标他能够漏出来的那部分
     (8) 对人物画框提取特征时，框不能太大，也不能太小，要做到正正好好把人提取出来，这样才能在后续做好多目标跟踪工作。
     (8) 注意：由于后续的训练任务需要图片命名的顺序应与生成的.xml文件对应，所以一定要注意每个视频的每一帧的图片都要进行过标注，保存
              对应帧的信息，不能漏！
    3.可以自行截取视频自己进行标注操作，方法如下：
     一定要注意：视频命名格式为xxxx_1.mp4，_前为视频名，_后面为视频编号。
     (1)在main_entrance.py中，解注释show_login = video_player()进入视频抽帧模块
     (2)先调整播放速率为x0.04实现分帧播放，然后输入自己想要截取的帧数，进行截图
     (3)耐心等待，截取的图片将会放在DS_image中
      注意：由于进度条等原因，开头有些图片无法截取，要注意是否全部截取成功。重点看开头信息有哪一张图片没有截取即可。

#### 负责人必看：

    1.标注完毕后/收到组员的数据后
    (1)将tempdata.csv中的数据复制到input.csv中
    (2)对input.csv按frame_id排序
    (3)保存，这样制作好了input.csv的初始数据集
    2. 按照yolov5 + deepsort + slowfast数据集用途摆放数据集，进入下一模块
    3. ——————新增功能——————convert_xml_ava.py—————
        convert_xml_ava.py文件用于形成xml文件和ava数据集格式的数据集，注意输入和输出地址的更改，注释中已有说明，需要自行更改。
    4.注意：由于后续的训练任务需要图片命名的顺序应与生成的.xml文件对应，所以一定要注意保证input.csv文件每个视频的每一帧的图片都要进行过标注，保存
           对应帧的信息，不能漏！
      漏了怎么办？  当images图片对应的xml文件不一致时，会在跟踪模块中的crop.py运行时，弹出错误信息，提示缺少了什么.xml文件，自行排查缺失了什么.xml文件
                  缺失文件的错误，一般是input.csv文件缺失对应图片标注的信息导致的，要去input.csv文件看一看缺失了哪一帧的信息，重新进行标注，之后再去
                  转xml,ava文件。
    5.注意发布软件《K-Lite_Codec_Pack_1715_Basic》以用于视频的正确播放。
